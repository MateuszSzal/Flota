/*1*/ 

select employee.last_name, job.function from EMPLOYEE, job, DEPARTMENT
where (EMPLOYEE.JOB_ID=job.JOB_ID) AND
(EMPLOYEE.DEPARTMENT_ID=DEPARTMENT.DEPARTMENT_ID) AND
( (department.name ='RESEARCH') OR (department.name='SALES'))
order by employee.last_name, department.name;

/*2*/ 

select employee.last_name, job.function from
employee, job, department, location
where 
(EMPLOYEE.DEPARTMENT_ID=DEPARTMENT.DEPARTMENT_ID)
AND
(EMPLOYEE.JOB_ID=job.JOB_ID) AND
(department.location_id = location.location_id)
AND
(location.REGIONAL_GROUP='BOSTON' OR location.REGIONAL_GROUP='NEW YORK')
AND (job.function = 'ANALYST');

/*3*/

select
'Pracownik ', employee.last_name, ' pracuje na etacie ',
job.function, ' od', employee.hire_date
from employee, job
where (employee.JOB_ID= job.JOB_ID);

/*4*/
SELECT max(ORDER_DATE) FROM SALES_ORDER;


SELECT E.LAST_NAME, D.NAME, SUM(S.TOTAL) AS "TOTAL" FROM EMPLOYEE E, JOB J, DEPARTMENT D, SALES_ORDER S,
CUSTOMER C WHERE S.CUSTOMER_ID=C.CUSTOMER_ID AND C.SALESPERSON_ID=E.EMPLOYEE_ID AND
J.JOB_ID=E.JOB_ID AND D.DEPARTMENT_ID=E.DEPARTMENT_ID AND S.ORDER_DATE BETWEEN '91/10/01' AND '91/10/31'
GROUP BY E.LAST_NAME, D.NAME HAVING SUM(S.TOTAL)>1280;




/*5*/
select CUSTOMER.NAME, sum(sales_order.total)
from customer left join sales_order on
customer.customer_id = sales_order.customer_id group by name order by
sum(sales_order.total); // posortowane gratis

/*6*/

 SELECT l.regional_group AS miasto, COUNT(s.TOTAL) AS
liczba_zamowien, AVG(s.TOTAL) AS srednia_wartosc
FROM employee e JOIN department d ON (e.department_id =
d.department_id)
JOIN location l ON (d.location_id = l.location_id) JOIN
customer c ON (c.salesperson_id = e.employee_id)
JOIN sales_order s ON (s.customer_id =
c.customer_id) WHERE d.name = 'SALES' GROUP BY
l.regional_group;

/*7 */




SELECT customer.name, sales_order.order_date, item.quantity,
product.description
FROM customer FULL JOIN sales_order ON
customer.customer_id = sales_order.customer_id
FULL OUTER JOIN item ON sales_order.order_id = item.order_id
FULL OUTER JOIN product ON item.product_id = product.product_id;